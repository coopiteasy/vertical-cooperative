<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>
		<record id="view_partner_form_easy_my_coop" model="ir.ui.view">
            <field name="name">res.partner.form.easy_my_coop</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="arch" type="xml">
            	<sheet position="before">
            		<header>
            			<button string="Create Subscription" name="%(action_view_create_subscription)d"
                                type="action" context="{'default_active_id': active_id}" groups="easy_my_coop.group_energiris_manager"/>
                        <button string="Update info" name="%(action_view_update_partner_info)d"
                                type="action" context="{'default_active_id': active_id}" groups="easy_my_coop.group_energiris_manager"/>
                        <button string="Touch" name="touch_cooperator_type" type="object"  groups="base.group_system"/>
            		</header>
            	</sheet>
            	
            	<xpath expr="/form/sheet/group" position='before'>
					<group>
						<field name="representative" attrs="{'invisible':['|',('parent_id','=',False),('is_company','=',True)]}"/>
						<field name="cooperator" groups="base.group_system"/>
						<field name="cooperator_register_number" readonly="True" attrs="{'invisible':[('member','=',False)]}"/>
						<field name="legal_form" attrs="{'invisible':[('is_company','=',False)]}"/>
						<field name="company_register_number" readonly="True" attrs="{'invisible':[('is_company','=',False)]}"/>
						<field name="coop_candidate" groups="easy_my_coop.group_energiris_user"/>
						<field name="member" groups="easy_my_coop.group_energiris_super_manager"/>
						<field name="cooperator_type" attrs="{'invisible':[('member','=',False)]}"/>
						<field name="effective_date" attrs="{'invisible':[('member','=',False)]}"/>
					</group>
					<group>
						<field name="gender" attrs="{'invisible':[('is_company','=',True)]}"/>
					</group>
					<group name="approvals">
						<field name="internal_rules_approved" />
						<field name="data_policy_approved" />
						<field name="financial_risk_approved" />
					</group>
	         	</xpath>
                
	         	<xpath expr="//page[@name='sales_purchases']" position='after'>
            		<page string="Shares" name="share" attrs="{'invisible':[('member','=',False)]}" groups="easy_my_coop.group_energiris_user">
            			<group>
			         		<field name="number_of_share"/>
			         		<field name="total_value"/>
		         		</group>
		         		<field name="share_ids">
		         			<tree create="false">
		         				<field name="effective_date"/>
		         				<field name="share_short_name"/>
		         				<field name="share_number" sum="Total of shares"/>
		         				<field name="share_unit_price"/>
		         				<field name="total_amount_line" sum="Total subscribed amount"/>
		         			</tree>
		         		</field>
		         	</page>
		         	<page string="Share subscriptions" name="share_subscription" attrs="{'invisible':[('cooperator','=',False)]}" groups="easy_my_coop.group_energiris_user">
		         		<field name="subscription_request_ids">
		         			<tree create="false" delete="false" edit="false">
		         				<field name="share_short_name"/>
		         				<field name="ordered_parts" sum="Total of shares"/>
		         				<field name="share_unit_price"/>
		         				<field name="subscription_amount" sum="Total subscribed amount"/>
		         				<field name="type"/>
		         				<field name="state"/>
		         			</tree>
		         		</field>
		         	</page>
            	</xpath>
            </field>
        </record>
        
        <record id="view_partner_tree_easy_my_coop" model="ir.ui.view">
            <field name="name">res.partner.tree.easy_my_coop</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_tree"/>
            <field name="arch" type="xml">
                <xpath expr="/tree/field[@name='display_name']" position='after'>
                	<field name="cooperator_register_number" />
                	<field name="cooperator_type"/>
                	<field name="effective_date"/>
                </xpath>
            </field>
        </record>
        
        <record id="view_res_partner_filter_coop" model="ir.ui.view">
            <field name="name">res.partner.select</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_res_partner_filter"/>
            <field name="arch" type="xml">
            	<xpath expr="//filter[@name='supplier']" position='after'>
                   <filter string="Cooperators" name="cooperator" domain="[('member','=',1)]" help="Cooperator Partners"/>
                </xpath>
                <filter name="salesperson" position="before">
                	<filter name="Cooperator Type" context="{'group_by': 'cooperator_type'}"/>
                </filter>
            </field>
        </record>
        

        <record id="action_partner_cooperator_form" model="ir.actions.act_window">
            <field name="name">Cooperator</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">res.partner</field>
            <field name="view_type">form</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="domain">[('cooperator','=',True),('member','=',True),('old_member','=',False)]</field>
            <field name="context">{'default_cooperator':1, 'search_default_cooperator':1}</field>
            <field name="filter" eval="True"/>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to add a contact in your address book.
              </p><p>
                OpenERP helps you easily track all activities related to
                a cooperator: discussions, history of business opportunities,
                documents, etc.
              </p>
            </field>
        </record>
        

        <record id="action_partner_cooperator_candidate_form" model="ir.actions.act_window">
            <field name="name">Cooperator candidates</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">res.partner</field>
            <field name="view_type">form</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="domain">[('cooperator','=',True),('coop_candidate','=',True),('member','=',False)]</field>
            <field name="context">{'default_cooperator':1}</field>
            <field name="filter" eval="True"/>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to add a contact in your address book.
              </p><p>
                OpenERP helps you easily track all activities related to
                a cooperator: discussions, history of business opportunities,
                documents, etc.
              </p>
            </field>
        </record>
        

        <record id="action_company_representative_form" model="ir.actions.act_window">
            <field name="name">Company representative</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">res.partner</field>
            <field name="view_type">form</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="domain">[('representative_of_member_company','=',True)]</field>
            <field name="filter" eval="True"/>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to add a contact in your address book.
              </p><p>
                OpenERP helps you easily track all activities related to
                a cooperator: discussions, history of business opportunities,
                documents, etc.
              </p>
            </field>
        </record>
        

        <record id="remove_partner_follower" model="ir.ui.view">
            <field name="name">res.partner.remove.follower.inherit</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="mail.view_emails_partner_info_form"/>
            <field name="arch" type="xml">
            	<field name="message_follower_ids" position="replace"/>
            </field>
        </record>
	</data>
</openerp>
